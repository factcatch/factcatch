<!DOCTYPE html>
<html lang="en">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- <meta charset="UTF-8"> -->
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles/style.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles/modal.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles/font.css') }}">
    <!-- <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles/graph.css') }}"> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- <link href='https://fonts.googleapis.com/css?family=Open+Sans|Open+Sans+Condensed:300,700' rel='stylesheet' type='text/css'> -->
    <!-- <script type="text/javascript" src="{{ url_for('static', filename='js/fact.js') }}"></script> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script> -->

    <script src="https://d3js.org/d3.v4.min.js"></script>
    <!-- <script src="//d3js.org/d3-scale-chromatic.v1.min.js"></script> -->

    <!-- conversation -->
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Fact Checking</title>
    <link rel='stylesheet' id='style-css' href="{{ url_for('static', filename='styles/style_conservation.css') }}"
        type='text/css' media='all' />
</head>

<body>
    <div id="budget-modal" class="modal">
        <!-- Modal content -->
        <div class="modal-content">
            <div class="modal-header">
                <span class="close">&times;</span>
                <h2>Optimize Budget Allocation</h2>
            </div>
            <div class="modal-body">
                <form method=post action="/" enctype=multipart/form-data> <h4>Budget</h4>
                    <input type=number value=0 name=budget style="font-size: 18px;">
                    <input type="submit" value="OK" class="button">
                </form>
            </div>
        </div>
    </div>
    <div class="grid-container">
        <div class="header">
            <div class="grid-header">
                <div id="logo-griffith">
                    <a href="/">
                        <div>Fact Checking</div>
                    </a>
                </div>
                <div id="select-file" class="header-content">
                    <form method=post action="/upload" enctype=multipart/form-data> <input type="file" name="file"
                        id="file" class="inputfile" data-multiple-caption="{count} files selected" multiple />
                    <input type=submit value=Upload id="upload-btn">
                    </form>
                </div>
                <div class="header-content" style="text-align: right;">
                    <button class="button">
                        <a href="/download" style="color: white">Take Snapshot</a>
                    </button>
                    <!-- <a class="button" href="/download">Take Snapshot</a> -->
                    <button class="button" id="myBtn">Optimize Budget Allocation</button>
                    <button class="button">Stop Feedback</button>
                </div>
            </div>
        </div>
        <div id="block-content">
            <div>
                <div id="title-list-claim">
                    <!-- <span>Claims</span> -->
                    <select name="mode" onchange="selectMode(this)">
                        <option value="block-list-claim" selected>Claims</option>
                        <option value="block-list-source">Sources</option>
                    </select>
                    <input type="text" id="input-for-claim" onkeyup="searchClaim()" placeholder="Search for claims.."
                        title="Type in a name">
                </div>
                <div id="block-list-claim" class="listcontent item-select">
                    <ul id="list-claim">
                        {% for claim in data %}
                        <li onclick="selectClaim({{ loop.index }},{{ claim }});drawRelation({{ claim }})"
                            id="{{ claim.id }}">
                            <div>
                                <span class="no-claim">{{ loop.index }}. </span> {{ claim.claim }}
                            </div>
                            <div class="container">
                                <div class="progress2 progress-moved">
                                    <div class="progress-bar2">
                                    </div>
                                </div>
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
                <div id="block-list-source" class="listcontent item-select">
                    {%for source in sources%}
                    <div class="source-item">{{ source[0] }}</div>
                    <div class="content-source-item">
                        <ul id="list-claim">
                            {% for claim in source[1] %}
                            <li onclick="selectClaim({{ loop.index }},{{ claim }});drawRelation({{ claim }})"
                                id="{{ claim.id }}">
                                <div style="font-size: 12px;">
                                    <span class="no-claim" style="font-size: 12px;">{{ loop.index }}. </span>
                                    {{ claim.claim }}
                                </div>
                                <div class="container">
                                    <div class="progress2 progress-moved">
                                        <div class="progress-bar2" style="height: 2px;">
                                        </div>
                                    </div>
                                </div>
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <div class="detail content">
                <div style="height: 580px;">
                    <div class="tab">
                        <button class="tablinks" onclick="openCity(event,'info-claim')" id="defaultOpen">Detail</button>
                        <button class="tablinks" onclick="openCity(event, 'sources')">Sources</button>
                        <div>
                            <form method=post action="/process">
                                <input type="hidden" name="claimId" value="{{ data[0].claim_id }}">
                                <!-- <div class="validation-claim"> -->
                                <input type=submit style="margin-right: 30px;" class="btn-validation" name="Credibility"
                                    value="Non-Credibility">
                                <input type=submit class="btn-validation" name="Credibility" value="Credibility">
                                <!-- </div> -->
                            </form>
                        </div>
                    </div>
                    <div id="info-claim" class="tabcontent item-tab">
                        <div>
                            <div>
                                <h4>
                                    Origins
                                </h4>
                                <p id="origins-claim">
                                    {{ data[0].origins }}
                                </p>
                            </div>
                            <div>
                                <h4>
                                    Description
                                </h4>
                                <span>
                                    <span id="description-short">
                                        {{ data[0].description }}
                                    </span>
                                    <span id="dots">...</span>
                                    <span id="more">
                                        {{ data[0].description }}
                                    </span>

                                    <button onclick="readMore()" id="btn-readmore" class="button">Read more</button>
                            </div>
                            <div>
                                <h4>
                                    Example
                                </h4>
                                <p id="example-claim">
                                    {{ data[0].example }}
                                </p>
                            </div>
                            <div>
                                <h4>
                                    Originally Published
                                </h4>
                                <p id="originally-published-claim">
                                    {{ data[0].originally_published }}
                                </p>
                            </div>
                            <div>
                                <h4>
                                    Last Updated
                                </h4>
                                <p id="last-updated-claim">
                                    {{ data[0].last_updated }}
                                </p>
                            </div>
                            <div id="tag-claim">
                                {% for tag in data[0].tags%}
                                <span class="tag-claim-item"> #{{ tag }} </span>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    <div id="sources" class="tabcontent item-tab">
                        <div class="chart"
                            style="grid-column-start:1;grid-column-end: 3;text-align: center;background-color: #fff;">
                        </div>
                    </div>
                </div>
                <div id="my_dataviz"></div>
            </div>
        </div>
    </div>
    <!-- <script type="text/javascript" src="{{ url_for('static', filename='js/d3.v3.min.js') }}"></script> -->
    <script src="https://d3js.org/d3.v3.min.js"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='js/jquery.min.js') }}"></script>
    <!-- <script type="text/javascript" src="{{ url_for('static', filename='js/conversation.min.js') }}"></script> -->
    <script type="text/javascript" src="{{ url_for('static', filename='js/fact.js') }}"></script>
    <script src="https://d3js.org/d3.v4.js"></script>
    <script>

        // set the dimensions and margins of the graph
        var margin = { top: 30, right: 30, bottom: 30, left: 30 },
            width = 450 - margin.left - margin.right,
            height = 450 - margin.top - margin.bottom;

        // append the svg object to the body of the page
        var svg = d3.select("#my_dataviz")
            .append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform",
                "translate(" + margin.left + "," + margin.top + ")");

        // Labels of row and columns
        var myGroups = ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J"]
        var myVars = ["v1", "v2", "v3", "v4", "v5", "v6", "v7", "v8", "v9", "v10"]

        // Build X scales and axis:
        var x = d3.scaleBand()
            .range([0, width])
            .domain(myGroups)
            .padding(0.01);
        svg.append("g")
            .attr("transform", "translate(0," + height + ")")
            .call(d3.axisBottom(x))

        // Build X scales and axis:
        var y = d3.scaleBand()
            .range([height, 0])
            .domain(myVars)
            .padding(0.01);
        svg.append("g")
            .call(d3.axisLeft(y));

        // Build color scale
        var myColor = d3.scaleLinear()
            .range(["white", "#69b3a2"])
            .domain([1, 100])

        //Read the data
        d3.csv("https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/heatmap_data.csv", function (data) {

            svg.selectAll()
                .data(data, function (d) { return d.group + ':' + d.variable; })
                .enter()
                .append("rect")
                .attr("x", function (d) { return x(d.group) })
                .attr("y", function (d) { return y(d.variable) })
                .attr("width", x.bandwidth())
                .attr("height", y.bandwidth())
                .style("fill", function (d) { return myColor(d.value) })

        })

    </script>
    <script>
        $(document).ready(function () {
            document.getElementById('{{ data[0].id }}').click();
        });
    </script>
</body>
<script type="text/javascript" src="{{ url_for('static', filename='js/modal.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/search.js') }}"></script>

</html>